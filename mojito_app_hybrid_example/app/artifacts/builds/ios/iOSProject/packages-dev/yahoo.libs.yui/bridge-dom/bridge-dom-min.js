YUI.add("bridge-dom",function(e,t){function i(){i.superclass.constructor.apply(this,arguments)}var n=e.guid();e.DOMService={_clearWatch:{},ERROR:{SERVICE_UNAVAILABLE:1},ERROR_MESSAGE:{SERVICE_UNAVAILABLE:"service unavailable"},services:{sContext:{getContextId:function(t,r,i,s){s.a={id:n},s.c="success",setTimeout(function(){e.Bridge.sendResponses([s])},0)},cancelMethod:function(t,n,r){var i=e.DOMService._clearWatch[r.i];i&&(i(),delete e.DOMService._clearWatch[r.i])}}},sendMessage:function(t){var n,r,i;for(n=0,r=t.length;n<r;n++)i=new e.DOMService.Request(t[n]),i.send()},_unavailableFailure:function(t,n){t.c="failure",t.a={code:e.DOMService.ERROR.SERVICE_UNAVAILABLE,message:e.DOMService.ERROR_MESSAGE.SERVICE_UNAVAILABLE},setTimeout(function(){n(t.a)},0)},Request:function(e){this.init(e)}},e.DOMService.Request.prototype={init:function(e){this.msg=e,this.id=e.i,this.service=e.h,this.method=e.m},send:function(){var t=this.msg,n=e.DOMService.services,r=this.service||"sContext",i=e.bind(this.onCallback,this,"success"),s=e.bind(this.onCallback,this,"failure"),o=t.m,u;return r&&n[r]&&n[r][o]?typeof n[r][o]=="function"&&(u=n[r][o](i,s,t.a,t)):e.DOMService._unavailableFailure(t,s),u},onCallback:function(t,r){var i=this.msg;i.a=r,i.d=[n],i.c=t,i.p=i.p||{},e.Bridge.sendResponses([i])}};var r={_onMotion:function(t,n,i,s,o){var u=e.config.win,a;"ondevicemotion"in u&&"addEventListener"in u?(a=function(e){r._watch(t,n,e),o&&u.removeEventListener("devicemotion",a,!0)},o||(s.p={c:!1},e.DOMService._clearWatch[s.i]=function(){u.removeEventListener("devicemotion",a,!0)}),u.addEventListener("devicemotion",a,!0)):e.DOMService._unavailableFailure(s,n)},_watch:function(t,n,r){var i={timestamp:Number(new Date)};r.acceleration?(e.mix(i,r.acceleration),t(i)):n&&(i.code=e.DOMService.ERROR.SERVICE_UNAVAILABLE,i.message=e.DOMService.ERROR_MESSAGE.SERVICE_UNAVAILABLE,n(i))},getAcceleration:function(e,t,n,i){r._onMotion(e,t,n,i,!0)},watchAcceleration:function(e,t,n,i){r._onMotion(e,t,n,i,!1)}};e.DOMService.services.sAccelerometer=r,e.DOMService.services.sGeo={getLocation:function(t,n,r){e.config.win.navigator.geolocation.getCurrentPosition(t,n,r)},watchLocation:function(t,n,r,i){i.p={c:!1};var s=e.config.win.navigator.geolocation,o=s.watchPosition(t,n,r);e.DOMService._clearWatch[i.i]=function(){s.clearWatch(o)}}},e.extend(i,e.BridgeBase.Delegate,{format:function(e){return e},parse:function(e){return e},_getDelegateImpl:function(){return e.DOMService}}),e.BridgeBase.addTransport("dom",i,!0),e.BridgeBase.DOM=i,e.Bridge=new e.BridgeBase({type:"dom"})},"@VERSION@",{requires:["bridge-delegate"]});
